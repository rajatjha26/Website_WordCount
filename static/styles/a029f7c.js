var loadingOverlay='<div class="loading-overlay"><span class="spinner"></span></div>';var delay=function(){var timer=0;return function(callback,ms){clearTimeout(timer);timer=setTimeout(callback,ms)}}();function stickFooter(){if($("#footer")[0]){$("#footer").css("margin-top",0);var bodyHeight=$("body").height();if($(window).height()>bodyHeight){$("#footer").css("margin-top",$(window).height()-bodyHeight)}}}function initializeSidebar(){if(Cookies.get("sidebar")==="collapsed"){$(".sidebar").addClass("sidebar--collapsed");$(".content").addClass("content--sidebar--collapsed");$(".sidebar--toogle i").removeClass("zmdi-chevron-left");$(".sidebar--toogle i").addClass("zmdi-chevron-right");$(function(){$('.sidebar [data-toggle="tooltip"]').tooltip("enable")})}else{Cookies.set("sidebar","expended");$(".sidebar").removeClass("sidebar--collapsed");$(".content").removeClass("content--sidebar--collapsed");$(".sidebar--toogle i").removeClass("zmdi-chevron-right");$(".sidebar--toogle i").addClass("zmdi-chevron-left");$(function(){$('.sidebar [data-toggle="tooltip"]').tooltip("disable")})}}$.fn.brokk.loadingTemplate=loadingOverlay;function initializeBrokk(){var defaultOnSuccess=function(args){this.onSuccess(args);initializePlugins();notify(args.data.message,"success")};var defaultOnError=function(args){this.onError(args);notify(args.xhr.responseJSON,"danger",12e3)};$(".brokk").brokk({onSuccess:defaultOnSuccess,onError:defaultOnError});$(".brokk-reload").brokk({fireEvent:$.fn.brokk.fireEvents.ON_CLICK,onSuccess:function(args){this.onSuccess(args);initializePlugins();notify(args.data.message,"success");location.reload()},onError:defaultOnError});$(".brokk-delete").brokk({fireEvent:$.fn.brokk.fireEvents.ON_CLICK,requestMethod:"DELETE",showOverlay:false,onSuccess:function(args){this.fireSuccessElements();notify(args.data.message,"success");var targets=this.options.toUpdateElements;if(typeof args.data.targets!=="undefined"){targets=args.data.targets}for(var i=0,len=targets.length;i<len;i++){var t=targets[i];(function(target){$(target).animateCss("fadeOutRight",function(){$(target).remove()})})(t)}},onError:defaultOnError});$(".brokk-form").brokk({fireEvent:$.fn.brokk.fireEvents.ON_SUBMIT,requestMethod:"POST",before:function(args){this.before(args);this.options.requestParams=this.$element.serialize()},onSuccess:defaultOnSuccess,onError:defaultOnError});$(".brokk-delete-confirmation").brokk({fireEvent:$.fn.brokk.fireEvents.MANUAL,requestMethod:"DELETE",showOverlay:false,onClick:function(){var plugin=this;var obj=plugin.$element[0];if(obj.hasAttribute("data-confirm")){var neverShow=false;var swalParams={title:obj.getAttribute("data-confirm"),text:obj.getAttribute("data-confirm-text"),icon:"warning",buttons:{cancel:{text:"Cancel",visible:true,className:"btn",closeModal:true},confirm:{value:"confirm",text:"OK",visible:true,className:"btn btn-primary",closeModal:true}}};if(obj.hasAttribute("data-confirm-never-show")){if(Cookies.get(obj.getAttribute("data-confirm-never-show"))==1){plugin.fire();return}else{neverShow=true;var input=document.createElement("label");input.className="custom-control custom-checkbox";input.appendChild($.parseHTML("<input id='js-never-show-input' type='checkbox' class='custom-control-input'>")[0]);input.appendChild($.parseHTML("<span class='custom-control-indicator'></span>")[0]);input.appendChild($.parseHTML("<span class='custom-control-description'>Don't ask me next time</span>")[0]);swalParams["content"]=input}}swal(swalParams).then(function(result){if(result===null){return}plugin.fire();if(neverShow&&$("#js-never-show-input").is(":checked")){Cookies.set(obj.getAttribute("data-confirm-never-show"),1)}}).catch(swal.noop)}else{plugin.fire()}},onSuccess:function(args){this.fireSuccessElements();notify(args.data.message,"success");var targets=this.options.toUpdateElements;if(typeof args.data.targets!=="undefined"){targets=args.data.targets;for(var i=0,len=targets.length;i<len;i++){var t=targets[i];(function(target){$(target).animateCss("fadeOutRight",function(){$(target).remove()})})(t)}}else{if(typeof unSelectTranslations==="function"){unSelectTranslations()}}if(typeof updateTranslationEditorToolbar==="function"){updateTranslationEditorToolbar()}},onError:defaultOnError})}function toggleSidebar(){Cookies.get("sidebar")==="expended"?Cookies.set("sidebar","collapsed"):Cookies.set("sidebar","expended");initializeSidebar()}$.fn.extend({animateCss:function(animationName,callback){var animationEnd="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";this.addClass("animated "+animationName).one(animationEnd,function(){$(this).removeClass("animated "+animationName);if(typeof callback!=="undefined"){callback()}})}});$.fn.editable.defaults.ajaxOptions={type:"PATCH"};initializeSidebar();function initializePlugins(){initializeBrokk();if($(".quick-stats__chart")[0]){$(".quick-stats__chart").sparkline("html",{enableTagOptions:true})}$(".editable").editable({placement:"auto"});$(".select2").select2({dropdownAutoWidth:"true",width:"auto"});$("input.flexdatalist:not(.flexdatalist-set):not(.autodiscover-disabled)").flexdatalist();$(".dataTable").each(function(){if(!$.fn.dataTable.isDataTable($(this))){$(this).DataTable({aoColumnDefs:[{retrieve:true,bSortable:false,aTargets:["nosort"]}]})}});$('[data-toggle="tooltip"]').tooltip({trigger:"hover"});$('[data-toggle="tooltip-html"]').tooltip({html:true});$('[data-toggle="popover"]').popover();$('[data-toggle="popover-html"]').popover({html:true});if($("input-mask")[0]){$(".input-mask").mask()}$('a[data-toggle="tab"]').on("hidden.bs.tab",function(){$(".nav-steps").find(".nav-link.active").parent().prevAll().each(function(index,element){$(element).find(".nav-link").addClass("visited")});$(".nav-steps").find(".nav-link.active").parent().nextAll().each(function(index,element){$(element).find(".nav-link").removeClass("visited")})});autosize(document.querySelectorAll("textarea"));$("body").on("click","[data-ma-action]",function(e){e.preventDefault();var $this=$(this);var action=$this.data("ma-action");var target="";switch(action){case"search-open":$(".search").addClass("search--toggled");break;case"search-close":$(".search").removeClass("search--toggled");break;case"aside-open":target=$this.data("ma-target");$this.addClass("toggled");$(target).addClass("toggled");$(".content, .header").append('<div class="ma-backdrop" data-ma-action="aside-close" data-ma-target='+target+" />");break;case"aside-close":target=$this.data("ma-target");$('[data-ma-action="aside-open"], '+target).removeClass("toggled");$(".content, .header").find(".ma-backdrop").remove();break;case"print":window.print();break;case"clear-localstorage":swal({title:"Are you sure?",text:"This can not be undone!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",confirmButtonText:"Yes, clear it",cancelButtonText:"No, cancel"}).then(function(){localStorage.clear();swal("Cleared!","Local storage has been successfully cleared","success")});break;case"login-switch":target=$this.data("ma-target");$(".login__block").removeClass("active");$(target).addClass("active");break;case"toolbar-search-open":$(this).closest(".toolbar").find(".toolbar__search").fadeIn(200);$(this).closest(".toolbar").find(".toolbar__search input").focus();break;case"toolbar-search-close":$(this).closest(".toolbar").find(".toolbar__search input").val("");$(this).closest(".toolbar").find(".toolbar__search").fadeOut(200);break}});$("body").on("focus",".search__text",function(){$(this).closest(".search").addClass("search--focus")});$("body").on("blur",".search__text",function(){if(!$(this).hasClass("keep")){$(this).val("")}$(this).closest(".search").removeClass("search--focus")});$("body").on("click",".navigation__sub > a",function(e){e.preventDefault();$(this).parent().toggleClass("navigation__sub--toggled");$(this).next("ul").slideToggle(250)});if($(".form-group--float")[0]){$(".form-group--float").each(function(){var p=$(this).find(".form-control").val();if(typeof p!=="undefined"&&!p.length==0){$(this).find(".form-control").addClass("form-control--active")}$(this).find("label").show()});$("body").on("blur",".form-group--float .form-control",function(){var i=$(this).val();if(i.length==0){$(this).removeClass("form-control--active")}else{$(this).addClass("form-control--active")}})}$("body").on("focus",".dataTables_filter input[type=search]",function(){$(this).closest(".dataTables_filter").addClass("dataTables_filter--toggled")});$("body").on("blur",".dataTables_filter input[type=search]",function(){$(this).closest(".dataTables_filter").removeClass("dataTables_filter--toggled")});if($(".dropzone")[0]){$(".dropzone").dropzone({uploadMultiple:false,autoProcessQueue:false,resizeWidth:$(".dropzone").attr("data-width"),resizeHeight:$(".dropzone").attr("data-height"),resizeMethod:$(".dropzone").attr("data-method"),maxFiles:1,maxFilesSize:2,url:$(".dropzone").attr("data-action"),init:function(){this.on("addedfile",function(file,response){var _this=this;var filesQ=_this.getAcceptedFiles();if(filesQ.length>0){for(var i=0;i<filesQ.length;i++){_this.removeFile(filesQ[i])}}$("#dropzone-submit").prop("disabled",false);$("#dropzone-submit").removeClass("disabled");$("#dropzone-submit").on("click",function(e){_this.processQueue()})});this.on("sending",function(){$("#dropzone-submit").addClass("disabled");$("#dropzone-submit").prop("disabled",true)});this.on("success",function(file,response){var uploadedFileUrl=$(".dropzone-modal").attr("data-uploadedFile-url");var elToRefresh=$($(".dropzone-modal").attr("data-refreshEl"));if(typeof uploadedFileUrl!==undefined&&typeof elToRefresh!==undefined){$(elToRefresh).attr("src",file.dataURL)}$(".dropzone-modal").html(response);initializePlugins()})}})}if($(".datetime-picker")[0]){$(".datetime-picker").flatpickr({enableTime:true,nextArrow:'<i class="zmdi zmdi-long-arrow-right" />',prevArrow:'<i class="zmdi zmdi-long-arrow-left" />'})}if($(".date-picker")[0]){$(".date-picker").flatpickr({enableTime:false,nextArrow:'<i class="zmdi zmdi-long-arrow-right" />',prevArrow:'<i class="zmdi zmdi-long-arrow-left" />'})}if($(".time-picker")[0]){$(".time-picker").flatpickr({noCalendar:true,enableTime:true})}if($(".content.content--full")[0]){$(".navigation-trigger").addClass("hidden-xl-down")}if($(".easy-pie-chart")[0]){$(".easy-pie-chart").each(function(){var value=$(this).data("value");var size=$(this).data("size");var trackColor=$(this).data("track-color");var barColor=$(this).data("bar-color");$(this).find(".easy-pie-chart__value").css({lineHeight:size+"px",fontSize:size/4+"px",color:barColor});$(this).easyPieChart({animate:false,barColor:barColor,trackColor:trackColor,scaleColor:"rgba(0,0,0,0)",lineCap:"round",lineWidth:2,size:size})})}stickFooter();$(document).on("click",'.btn-group[data-toggle="buttons"] label',function(){$(this).parent().find("input:checked").prop("checked",false);$(this).find("input").prop("checked",true)});$(document).on("submit","form",function(){$(this).find(":submit").prop("disabled",true)});$(document).on("click",".listview__item-collapse a",function(){var $icon=$(this).closest(".listview__item-collapse").find(".listview__item-collapse-icon");if($(this).hasClass("collapsed")){$icon.addClass("zmdi-caret-right");$icon.removeClass("zmdi-caret-down")}else{$icon.addClass("zmdi-caret-down");$icon.removeClass("zmdi-caret-right")}})}function updateLanguagesChoices(selector_lfrom,selector_lto){var selectedLanguageFrom=$(selector_lfrom).val();var selectedLanguagesTo=$(selector_lto).val();if(selectedLanguageFrom!==""){$(selector_lto+">option[disabled]").prop("disabled",false);$(selector_lto+">option[value='"+selectedLanguageFrom+"']").prop("disabled",true);var cleanedLanguagesTo=selectedLanguagesTo.filter(function(val){return val!==selectedLanguageFrom});$(selector_lto).val(cleanedLanguagesTo).trigger("change").select2()}}
function notify(message,type,delay){delay=delay||7e3;if(typeof message!=="undefined"&&0!==message.length){$.notify({message:message},{type:type,allow_dismiss:true,placement:{from:"top",align:"right"},delay:delay,animate:{enter:"animated fadeInRight",exit:"animated fadeOutRight"},offset:{x:45,y:45},z_index:5e3})}}$(function(){$(".notify-success").each(function(){notify(this.dataset.message,"success")});$(".notify-warning").each(function(){notify(this.dataset.message,"warning")});$(".notify-info").each(function(){notify(this.dataset.message,"info")});$(".notify-error").each(function(){notify(this.dataset.message,"danger")})});
$(document).ajaxError(function(event,jqxhr,settings,thrownError){if(jqxhr.status===403){window.location.reload()}});function addLoadingOverlay(target){if($(target).find(".loading-overlay").length==0){$(target).append(loadingOverlay)}}function askConfirmation(obj,url,params,method,target,callback){if(typeof obj!=="undefined"&&obj.hasAttribute("data-confirm")){var neverShow=false;var swalParams={title:obj.getAttribute("data-confirm"),text:obj.getAttribute("data-confirm-text"),icon:"warning",buttons:{cancel:{text:"Cancel",visible:true,className:"btn",closeModal:true},confirm:{value:"confirm",text:"OK",visible:true,className:"btn btn-primary",closeModal:true}}};if(obj.hasAttribute("data-confirm-never-show")){if(Cookies.get(obj.getAttribute("data-confirm-never-show"))==1){callback(url,params,method,target,obj);return}else{neverShow=true;var input=document.createElement("label");input.className="custom-control custom-checkbox";input.appendChild($.parseHTML("<input id='js-never-show-input' type='checkbox' class='custom-control-input'>")[0]);input.appendChild($.parseHTML("<span class='custom-control-indicator'></span>")[0]);input.appendChild($.parseHTML("<span class='custom-control-description'>Don't ask me next time</span>")[0]);swalParams["content"]=input}}swal(swalParams).then(function(result){if(result===null){return}showProgressMessage(obj);callback(url,params,method,target,obj);if(neverShow&&$("#js-never-show-input").is(":checked")){Cookies.set(obj.getAttribute("data-confirm-never-show"),1)}}).catch(swal.noop)}else{if(typeof obj!=="undefined"){showProgressMessage(obj)}callback(url,params,method,target,obj)}}function showProgressMessage(obj){if(obj.hasAttribute("data-progress-message")){notify(obj.getAttribute("data-progress-message"),"info")}}function ajaxRender(obj){var url=$(obj).attr("data-url");var params=$(obj).attr("data-params");if(typeof params!=="undefined"){params=JSON.parse(params)}var method=$(obj).attr("data-method");if(typeof method==="undefined"){method="GET"}var target=$(obj).attr("data-target");if(target!=="undefined"){target=$(target)}else{target=obj}askConfirmation(obj,url,params,method,target,ajaxRequest)}function ajaxRequest(url,params,method,target,obj){var overlay=$(obj).attr("data-overlay");if(typeof overlay==="undefined"||overlay!=="0"){addLoadingOverlay(target)}if(typeof obj!=="undefined"){$(obj).prop("disabled",true);$(obj).addClass("disabled")}$.ajax({url:url,type:method,dataType:"json",data:params,success:function(data){if(typeof obj!=="undefined"&&obj.hasAttribute("data-progress-message")){closeNotification()}notify(data.message,"success");$(target).html(data);initializePlugins()},error:function(xhr){if(typeof obj!=="undefined"&&obj.hasAttribute("data-progress-message")){closeNotification()}notify(xhr.responseJSON,"danger");$(target).find(".loading-overlay").remove()}}).always(function(){if(typeof obj!=="undefined"){$(obj).prop("disabled",false);$(obj).removeClass("disabled")}})}function ajaxRequestReload(url,params,method,target,obj){if(typeof obj!=="undefined"){$(obj).prop("disabled",true);$(obj).addClass("disabled")}$.ajax({url:url,type:method,dataType:"json",data:params,success:function(data){if(typeof obj!=="undefined"&&obj.hasAttribute("data-progress-message")){closeNotification()}notify(data.message,"success");location.reload()},error:function(xhr){if(typeof obj!=="undefined"&&obj.hasAttribute("data-progress-message")){closeNotification()}notify(xhr.responseJSON,"danger")}}).always(function(){if(typeof obj!=="undefined"){$(obj).prop("disabled",false);$(obj).removeClass("disabled")}})}function ajaxRequestForm(url,params,method,target,obj){obj=$(obj).find(":submit");if(typeof obj!=="undefined"){$(obj).prop("disabled",true);$(obj).addClass("disabled")}$.ajax({url:url,type:method,dataType:"json",data:params,success:function(data){notify(data.message,"success");if(typeof data.page!=="undefined"){$(target).html(data.page)}initializePlugins()},error:function(xhr){notify(xhr.responseJSON,"danger")}}).always(function(){if(typeof obj!=="undefined"){$(obj).prop("disabled",false);$(obj).removeClass("disabled")}})}function ajaxRequestDelete(url,params,method,target,obj){if(typeof obj!=="undefined"){$(obj).prop("disabled",true);$(obj).addClass("disabled")}$.ajax({url:url,type:method,dataType:"json",data:params,success:function(data){if(typeof obj!=="undefined"&&obj.hasAttribute("data-progress-message")){closeNotification()}if(typeof data.targets!=="undefined"){target=data.targets}if($.isArray(target)){for(var i=0,len=target.length;i<len;i++){var t=target[i];(function(target){$(target).animateCss("fadeOutRight",function(){$(target).remove()})})(t)}}else{$(target).animateCss("fadeOutRight",function(){$(target).remove()})}if(typeof data.messageType==="undefined"){notify(data.message,"success")}else{notify(data.message,data.messageType)}},error:function(xhr){if(typeof obj!=="undefined"&&obj.hasAttribute("data-progress-message")){closeNotification()}notify(xhr.responseJSON,"danger")}}).always(function(){if(typeof obj!=="undefined"){$(obj).prop("disabled",false);$(obj).removeClass("disabled")}})}function ajaxRequestFlotchart(url,params,method,target){var targetParent=target.parent().closest("div");addLoadingOverlay(targetParent);$.ajax({url:url,type:method,dataType:"json",data:params,success:function(data){$.plot(target,data.lines,data.options)},error:function(xhr){notify(xhr.responseJSON,"danger")}}).always(function(){$(targetParent).find(".loading-overlay").remove();target.bind("plothover",function(event,pos,item){if(item){var x=item.series.data[item.dataIndex][2],y=item.datapoint[1];$(".flot-tooltip").html(x+"<br/>"+y).css({top:item.pageY+5,left:item.pageX+5}).show()}else{$(".flot-tooltip").hide()}});$("<div class='flot-tooltip' class='chart-tooltip'></div>").appendTo("body")})}function closeNotification(){setTimeout(function(){$.notifyClose()},1500)}function initRender(){$(".ajax-render").each(function(i,obj){ajaxRender(obj)})}$(document).ready(function(){$(".ajax-render-onclick").each(function(i,obj){var hash=$(obj).attr("data-hash");if(hash!=="undefined"&&window.location.hash!=""){$(obj).removeClass("ajax-render");if("#"+hash==window.location.hash){$(obj).addClass("active");ajaxRender(obj)}else{$(obj).removeClass("active")}}});initRender();$(document).on("click",".ajax-render-onclick",function(){var url=$(this).attr("data-url");var params=$(this).attr("data-params");if(typeof params!=="undefined"){params=JSON.parse(params)}var method=$(this).attr("data-method");if(typeof method==="undefined"){method="GET"}var target=$(this).attr("data-target");if(typeof target!=="undefined"){target=$(target)}else{target=this}var hash=$(this).attr("data-hash");if(typeof hash!=="undefined"){window.location.hash=hash}askConfirmation(this,url,params,method,target,ajaxRequest)});$(document).on("click",".ajax-reload",function(){var url=$(this).attr("data-url");var params=$(this).attr("data-params");if(typeof params!=="undefined"){params=JSON.parse(params)}var method=$(this).attr("data-method");if(typeof method==="undefined"){method="POST"}askConfirmation(this,url,params,method,null,ajaxRequestReload)});$(document).on("submit",".ajax-form",function(e){e.preventDefault();var url=$(this).attr("action");var params=$(this).serialize();var method=$(this).attr("method");if(typeof method==="undefined"){method="POST"}askConfirmation(this,url,params,method,this,ajaxRequestForm)});$(document).on("click",".ajax-delete",function(){var url=$(this).attr("data-url");var params=$(this).attr("data-params");if(typeof params!=="undefined"){params=JSON.parse(params)}var target=$(this).attr("data-target");if(typeof target!=="undefined"){target=$(target)}else{target=this}var method=$(this).attr("data-method");if(typeof method==="undefined"){method="DELETE"}askConfirmation(this,url,params,method,target,ajaxRequestDelete)});$(document).on("click",".ajax-request",function(){var url=$(this).attr("data-url");var params=$(this).attr("data-params");if(typeof params!=="undefined"){params=JSON.parse(params)}var method=$(this).attr("data-method");if(typeof method==="undefined"){method="GET"}askConfirmation(this,url,params,method,this,ajaxRequest)})});